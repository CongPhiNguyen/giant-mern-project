"use strict";(self.webpackChunkfe_authen=self.webpackChunkfe_authen||[]).push([[186],{4186:function(e,n,t){t.r(n),t.d(n,{default:function(){return j}});var i=t(2791),a=t(9472),l=t(5531),o=t(3430),s=t(1405),c=t(8185),r=t(4569),u=t.n(r),d=t(9768),m=t(5242),g=t(1582),h=t(184);function f(e){var n,t,i,a,l=(0,s.I0)(),o=(0,s.v9)((function(e){return e.sharedSlice.currentUserInformation})),c=(0,s.v9)((function(e){return e.imageSlice.uploadingImageInfo}));return(0,h.jsxs)("div",{className:"".concat(e.isShow?"block":"hidden"),children:[(0,h.jsxs)("section",{className:"input-area",children:[0!==e.listImageLength&&(0,h.jsxs)("div",{className:"img-manage",children:[(0,h.jsx)("p",{className:"img-index",children:"".concat(e.index+1,"/").concat(e.listImageLength)}),(0,h.jsx)("p",{className:"delete-icon noselect",onClick:function(){e.deleteCurrentImageFromQueue(e.index)},children:"Delete"})]}),(0,h.jsx)("input",{type:"text",className:"title",placeholder:"Nh\u1eadp ti\xeau \u0111\u1ec1",value:null===(n=c[e.index])||void 0===n?void 0:n.title,onChange:function(n){l((0,g.QG)({index:e.index,value:{title:n.target.value}}))}}),(0,h.jsx)("div",{className:"user-info",children:(0,h.jsx)("img",{src:null===o||void 0===o?void 0:o.avatarURL,alt:"",className:"user-avatar"})}),(0,h.jsx)("textarea",{className:"image-description",rows:"2",placeholder:"Nh\u1eadp m\xf4 t\u1ea3",value:null===(t=c[e.index])||void 0===t?void 0:t.description,onChange:function(n){l((0,g.QG)({index:e.index,value:{description:n.target.value}}))}}),(0,h.jsx)("input",{type:"text",className:"alt-text",placeholder:"Nh\u1eadp v\u0103n b\u1ea3n thay th\u1ebf",value:null===(i=c[e.index])||void 0===i?void 0:i.alt,onChange:function(n){l((0,g.QG)({index:e.index,value:{alt:n.target.value}}))}})]}),(0,h.jsxs)("div",{className:"img-attribute",children:[(0,h.jsx)("p",{className:"title",children:"Th\xf4ng tin file"}),(0,h.jsxs)("p",{className:"file-info-concrete",children:["Size: ",(a=e.size,Math.round(100*a/1024)/100+"KB")," (".concat(e.width,"x").concat(e.height,")")]}),(0,h.jsxs)("p",{className:"file-info-concrete",children:["Last change: ",e.lastModified]})]})]})}var p=t(6871),v=t(8145);function x(){var e=(0,s.I0)(),n=(0,p.s0)(),t=(0,i.useState)([]),r=(0,o.Z)(t,2),x=r[0],j=r[1],N=(0,i.useState)([]),b=(0,o.Z)(N,2),I=b[0],S=b[1],w=(0,i.useState)([]),Z=(0,o.Z)(w,2),k=Z[0],C=Z[1],y=(0,i.useState)([]),L=(0,o.Z)(y,2),F=L[0],U=L[1],_=(0,i.useState)([]),R=(0,o.Z)(_,2),D=R[0],E=R[1],M=(0,i.useState)(-1),Q=(0,o.Z)(M,2),z=Q[0],G=Q[1],P=(0,i.useState)(0),W=(0,o.Z)(P,2),A=W[0],H=W[1],O=(0,s.v9)((function(e){return e.sharedSlice.currentUserInformation})),T=(0,s.v9)((function(e){return e.imageSlice.uploadingImageInfo}));(0,i.useEffect)((function(){O.username&&u().get(v.Z.PREFIX_URL+"/api/album/get-all-user-album",{params:{username:O.username}},{withCredentials:!0}).then((function(e){console.log("data",e),E(e.data.albumList)})).catch((function(e){console.log("err",e)}))}),[O.username]);var X=function(){if(0!==x.length){var e=new FormData;x.forEach((function(n){e.append("listImages",n)})),e.append("userID",O._id),T.forEach((function(n){e.append("imgInfo",JSON.stringify(n))}));var t,i=(0,a.Z)(e.entries());try{for(i.s();!(t=i.n()).done;){var l=t.value;console.log(l[0]+", "+l[1])}}catch(o){i.e(o)}finally{i.f()}!function(e){u().defaults.withCredentials=!0;var t={headers:{"content-type":"multipart/form-data"},onUploadProgress:function(e){H(Math.round(100*e.loaded/e.total))}},i=v.Z.PREFIX_URL+"/api/image/upload";u().post(i,e,t).then((function(e){console.log("data",e),n("/processing")})).catch((function(e){console.log("err",e)}))}(e)}else(0,d.Am)("You must choose at least 1 images to upload")},q=function(e){S((function(n){return n.filter((function(n,t){return t!==e}))})),j((function(n){return n.filter((function(n,t){return t!==e}))})),U((function(n){return n.filter((function(n,t){return t!==e}))})),k((function(n){return n.filter((function(n,t){return t!==e}))})),G(-1)};return console.log("currentInputValue",T),(0,h.jsx)(i.Fragment,{children:(0,h.jsxs)("div",{className:"uploading-box-container",children:[(0,h.jsxs)("div",{className:"percent-upload",children:[" ",(0,h.jsx)(m.x1,{percent:A,strokeWidth:1,strokeColor:"cyan"})]}),(0,h.jsxs)("div",{className:"heading",children:[(0,h.jsx)("p",{className:"more-icon",children:(0,h.jsx)(c.evw,{})}),(0,h.jsxs)("div",{className:"album-selection-container",children:[(0,h.jsxs)("select",{className:"album-selection",name:"album-selection",id:"album-upload-selection",children:[(0,h.jsx)("option",{value:"none",children:"..."}),D.map((function(e,n){return(0,h.jsx)("option",{value:e._id,children:e.albumName},n)}))]}),(0,h.jsx)("button",{className:"select-button",children:"Select"})]})]}),(0,h.jsxs)("div",{className:"main-content",children:[(0,h.jsxs)("div",{className:"img-upload-container",children:[x.map((function(n,t){return(0,h.jsx)("img",{src:I[t]?I[t]:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif",alt:"",id:"image-upload-".concat(t),className:"img-file-to-upload ".concat(t===z?"selected":""),onLoad:function(n){!function(n){"https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif"!==n.target.src&&(x.length<=F.length||U((function(t){var i,a;return e((0,g.QG)({index:t.length,value:{storage:null===(i=x[t.length])||void 0===i?void 0:i.size,dimension:{x:n.target.naturalWidth,y:n.target.naturalHeight},generateTime:null===(a=x[t.length])||void 0===a?void 0:a.lastModifiedDate.toISOString()}})),[].concat((0,l.Z)(t),[{width:n.target.naturalWidth,height:n.target.naturalHeight}])})))}(n)},onClick:function(){G(t)}},t)})),(0,h.jsx)("label",{className:"img-picker",htmlFor:"img-input",children:(0,h.jsx)("img",{className:"img-add",src:"https://cdn-icons-png.flaticon.com/512/1091/1091585.png",alt:""})}),(0,h.jsx)("input",{type:"file",id:"img-input",style:{display:"none"},onChange:function(n){!function(n){console.log(document.querySelector("#img-input").files);var t=n.target.files;e((0,g.p7)({length:n.target.files.length,fromIndex:x.length})),j((function(e){return[].concat((0,l.Z)(e),(0,l.Z)(t))})),C((function(e){return[].concat((0,l.Z)(e),(0,l.Z)(t))})),(0,l.Z)(t).forEach((function(e){var t=new FileReader,i=n;t.onload=function(e){i=e.target.result,S((function(e){return[].concat((0,l.Z)(e),[i])}))},t.readAsDataURL(e)}))}(n)},multiple:"multiple",accept:"image/gif, image/jpeg, image/png"})]}),(0,h.jsxs)("div",{className:"img-upload-infor",children:[-1!==z&&k.map((function(e,n){var t,i,a,l;return(0,h.jsx)(f,{isShow:n===z,index:n,listImageLength:x.length,deleteCurrentImageFromQueue:q,size:null===(t=x[n])||void 0===t?void 0:t.size,width:null===(i=F[n])||void 0===i?void 0:i.width,height:null===(a=F[n])||void 0===a?void 0:a.height,lastModified:null===(l=x[n])||void 0===l?void 0:l.lastModifiedDate.toString()},n)})),(0,h.jsx)("button",{className:"img-uploader",onClick:function(){X()},children:"Upload"})]})]})]})})}function j(){return(0,h.jsx)(i.Fragment,{children:(0,h.jsx)("div",{className:"page-container",children:(0,h.jsx)("div",{className:"content-container",children:(0,h.jsx)("section",{className:"uploading-box-wrapper",children:(0,h.jsx)(x,{})})})})})}}}]);
//# sourceMappingURL=186.e4d9e53e.chunk.js.map